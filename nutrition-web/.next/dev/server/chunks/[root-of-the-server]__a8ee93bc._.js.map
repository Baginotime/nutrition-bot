{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/NutritionApp/nutrition-web/lib/supabase.ts"],"sourcesContent":["// lib/supabase.ts\r\nimport { createClient } from '@supabase/supabase-js';\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\r\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\r\n\r\nif (!supabaseUrl || !supabaseAnonKey) {\r\n  throw new Error('Missing NEXT_PUBLIC_SUPABASE_URL or NEXT_PUBLIC_SUPABASE_ANON_KEY');\r\n}\r\n\r\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey);\r\n\r\n"],"names":[],"mappings":"AAAA,kBAAkB;;;;;AAClB;;AAEA,MAAM;AACN,MAAM;AAEN;;AAIO,MAAM,WAAW,IAAA,yMAAY,EAAC,aAAa"}},
    {"offset": {"line": 62, "column": 0}, "map": {"version":3,"sources":["file:///C:/NutritionApp/nutrition-web/app/api/users/route.ts"],"sourcesContent":["// app/api/users/route.ts\r\nimport { NextResponse } from 'next/server';\r\nimport { supabase } from '@/lib/supabase';\r\n\r\nexport async function POST(req: Request) {\r\n  try {\r\n    const body = await req.json();\r\n    const { age, gender, height, weight, activityLevel } = body;\r\n\r\n    // 1. создаём тестового пользователя из веб-версии\r\n    const { data: user, error: userError } = await supabase\r\n      .from('users')\r\n      .insert({\r\n        telegram_id: 'web-' + Date.now().toString(),\r\n        username: 'web_user',\r\n        first_name: 'Web Test',\r\n      })\r\n      .select()\r\n      .single();\r\n\r\n    if (userError || !user) {\r\n      console.error('Supabase users error /api/users:', userError);\r\n      return NextResponse.json(\r\n        { ok: false, error: userError?.message ?? 'Failed to create user' },\r\n        { status: 500 },\r\n      );\r\n    }\r\n\r\n    // 2. пишем профиль для этого пользователя\r\n    const { data: profile, error: profileError } = await supabase\r\n      .from('profiles')\r\n      .insert({\r\n        user_id: user.id,\r\n        age,\r\n        gender,\r\n        height,\r\n        weight,\r\n        activity_level: activityLevel,\r\n      })\r\n      .select()\r\n      .single();\r\n\r\n    if (profileError) {\r\n      console.error('Supabase profiles error /api/users:', profileError);\r\n      return NextResponse.json(\r\n        { ok: false, error: profileError.message },\r\n        { status: 500 },\r\n      );\r\n    }\r\n\r\n    return NextResponse.json(\r\n      { ok: true, user, profile },\r\n      { status: 200 },\r\n    );\r\n  } catch (e: any) {\r\n    console.error('Unhandled error /api/users:', e);\r\n    return NextResponse.json(\r\n      { ok: false, error: e?.message ?? 'Unknown server error' },\r\n      { status: 500 },\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":"AAAA,yBAAyB;;;;;AACzB;AACA;;;AAEO,eAAe,KAAK,GAAY;IACrC,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,EAAE,GAAG,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,aAAa,EAAE,GAAG;QAEvD,kDAAkD;QAClD,MAAM,EAAE,MAAM,IAAI,EAAE,OAAO,SAAS,EAAE,GAAG,MAAM,6HAAQ,CACpD,IAAI,CAAC,SACL,MAAM,CAAC;YACN,aAAa,SAAS,KAAK,GAAG,GAAG,QAAQ;YACzC,UAAU;YACV,YAAY;QACd,GACC,MAAM,GACN,MAAM;QAET,IAAI,aAAa,CAAC,MAAM;YACtB,QAAQ,KAAK,CAAC,oCAAoC;YAClD,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,IAAI;gBAAO,OAAO,WAAW,WAAW;YAAwB,GAClE;gBAAE,QAAQ;YAAI;QAElB;QAEA,0CAA0C;QAC1C,MAAM,EAAE,MAAM,OAAO,EAAE,OAAO,YAAY,EAAE,GAAG,MAAM,6HAAQ,CAC1D,IAAI,CAAC,YACL,MAAM,CAAC;YACN,SAAS,KAAK,EAAE;YAChB;YACA;YACA;YACA;YACA,gBAAgB;QAClB,GACC,MAAM,GACN,MAAM;QAET,IAAI,cAAc;YAChB,QAAQ,KAAK,CAAC,uCAAuC;YACrD,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,IAAI;gBAAO,OAAO,aAAa,OAAO;YAAC,GACzC;gBAAE,QAAQ;YAAI;QAElB;QAEA,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,IAAI;YAAM;YAAM;QAAQ,GAC1B;YAAE,QAAQ;QAAI;IAElB,EAAE,OAAO,GAAQ;QACf,QAAQ,KAAK,CAAC,+BAA+B;QAC7C,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,IAAI;YAAO,OAAO,GAAG,WAAW;QAAuB,GACzD;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}